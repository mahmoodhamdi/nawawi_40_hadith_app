# ุฎุทุฉ ุชุทููุฑ ุชุทุจูู ุงูุฃุฑุจุนูู ุงูููููุฉ

## ุชุงุฑูุฎ ุงูุชุญููู: 2025-12-13

---

## ููุฎุต ุงูุชุญููู

| ุงููููุงุณ | ุงููููุฉ |
|---------|--------|
| ุฅุฌูุงูู ูููุงุช Dart | 32 |
| ุฅุฌูุงูู ุฃุณุทุฑ ุงูููุฏ | ~3,500 |
| ุชุบุทูุฉ ุงูุงุฎุชุจุงุฑุงุช | ููุชุงุฒุฉ (237 ุงุฎุชุจุงุฑ) |
| ุชูููู ุฌูุฏุฉ ุงูููุฏ | A (ููุชุงุฒ) |

---

## 1. ุงููุดุงูู ุงูุญุฑุฌุฉ (ูุฌุจ ุฅุตูุงุญูุง ููุฑุงู)

### 1.1 ุนุฏู ูุฌูุฏ ูุนุงูุฌุฉ ุฃุฎุทุงุก ูู ุชุญููู JSON
**ุงูููู:** `lib/services/hadith_loader.dart`
```dart
// ุงููุดููุฉ: ูุง ููุฌุฏ try-catch
final List<dynamic> jsonList = json.decode(jsonString);
```
**ุงูุญู:**
```dart
static Future<List<Hadith>> loadHadiths() async {
  try {
    final String jsonString = await rootBundle.loadString(
      'assets/json/40-hadith-nawawi.json',
    );
    final List<dynamic> jsonList = json.decode(jsonString);
    return jsonList.map((item) => Hadith.fromJson(item)).toList();
  } on FormatException catch (e) {
    throw Exception('ุฎุทุฃ ูู ุชูุณูู ููู ุงูุจูุงูุงุช: $e');
  } catch (e) {
    throw Exception('ูุดู ุชุญููู ุงูุฃุญุงุฏูุซ: $e');
  }
}
```

### 1.2 ูุนุงูุฌุฉ DateTime ุจุฏูู ุญูุงูุฉ
**ุงูููู:** `lib/services/preferences_service.dart:27`
```dart
// ุงููุดููุฉ: ูุฏ ููุดู DateTime.parse
return DateTime.parse(timeString);
```
**ุงูุญู:**
```dart
static Future<DateTime?> getLastReadTime() async {
  final prefs = await SharedPreferences.getInstance();
  final timeString = prefs.getString(lastReadTimeKey);
  if (timeString == null) return null;
  try {
    return DateTime.parse(timeString);
  } catch (e) {
    // ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุชุงููุฉุ ููุณุญูุง
    await prefs.remove(lastReadTimeKey);
    return null;
  }
}
```

### 1.3 ุฑูู ุงูุฃุญุงุฏูุซ ููุชูุจ ูุฏููุงู
**ุงูููู:** `lib/screens/hadith_details_screen.dart:324`
```dart
// ุงููุดููุฉ: ุงูุฑูู 42 ููุชูุจ ูุฏููุงู
onPressed: widget.index < 42 ? () => _navigateToNextHadith(context) : null,
```
**ุงูุญู:** ุงุณุชุฎุฏุงู ุทูู ุงููุงุฆูุฉ ุงููุนูู ูู HadithCubit

---

## 2. ูุดุงูู ุงูุฃุฏุงุก

### 2.1 ุงูุจุญุซ ุบูุฑ ูุญุณูู
**ุงูููู:** `lib/screens/home_screen.dart:417-425`
- ุงูุจุญุซ ูุชู ุนูู ูู ุญุฑู ุจุฏูู debounce
- ุงูุจุญุซ case-sensitive
- ุงููุงุฆูุฉ ุชููุดุฃ ูู ุฌุฏูุฏ ูู ูู ูุฑุฉ

**ุงูุญู:**
```dart
// ุฅุถุงูุฉ debounce ููุจุญุซ
Timer? _debounce;

void _onSearchChanged(String value) {
  if (_debounce?.isActive ?? false) _debounce!.cancel();
  _debounce = Timer(const Duration(milliseconds: 300), () {
    setState(() {
      _searchQuery = value.trim().toLowerCase();
    });
  });
}

// ุจุญุซ ุบูุฑ ุญุณุงุณ ูุญุงูุฉ ุงูุฃุญุฑู
final filtered = _searchQuery.isEmpty
    ? state.hadiths
    : state.hadiths.where((h) =>
        h.hadith.toLowerCase().contains(_searchQuery) ||
        h.description.toLowerCase().contains(_searchQuery),
      ).toList();
```

### 2.2 ุฅูุฑุงุท ูู ุฅุฑุณุงู ุญุงูุฉ ุงูุตูุช
**ุงูููู:** `lib/cubit/audio_player_cubit.dart:65-72`
- Stream ุงูููุถุน ูุฑุณู ุชุญุฏูุซุงุช ูุซูุฑุฉ ุฌุฏุงู

**ุงูุญู:** ุงุณุชุฎุฏุงู throttle ุฃู distinct

---

## 3. ูุดุงูู ุฅููุงููุฉ ุงููุตูู (Accessibility)

### 3.1 ุนุฏู ูุฌูุฏ Semantic Labels
**ุงููููุงุช ุงููุชุฃุซุฑุฉ:**
- `lib/widgets/hadith_tile.dart`
- `lib/widgets/audio_player_widget.dart`

**ุงูุญู:**
```dart
Semantics(
  label: 'ุงูุญุฏูุซ ุฑูู $index',
  child: InkWell(
    // ...
  ),
)
```

### 3.2 ุฃุฒุฑุงุฑ ุจุฏูู tooltips
ุจุนุถ ุงูุฃุฒุฑุงุฑ ุชูุชูุฑ ุฅูู tooltip ูููุณุชุฎุฏููู

---

## 4. ุงููููุฒุงุช ุงููุงูุตุฉ

### 4.1 ูุธุงู ุงูููุถูุฉ/ุงูุฅุดุงุฑุงุช ุงููุฑุฌุนูุฉ โ ููุชูู
- ~~ูุง ูููู ูููุณุชุฎุฏู ุญูุธ ุฃุญุงุฏูุซ ููุถูุฉ~~
- ~~ููุท "ุขุฎุฑ ูุฑุงุกุฉ" ููุฌูุฏ~~

**ุชู ุชูููุฐ:**
- โ ุฅุถุงูุฉ `FavoritesCubit`
- โ ุชุฎุฒูู ูุงุฆูุฉ ุงูููุถูุฉ ูู SharedPreferences
- โ ุฅุถุงูุฉ ุฃููููุฉ ููุจ ูู ุดุงุดุฉ ุงูุชูุงุตูู
- โ ุฅุถุงูุฉ ููุชุฑ ููููุถูุฉ ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ

### 4.2 ูุดุงุฑูุฉ ูุชูุฏูุฉ โ ููุชูู
- ~~ูุง ููุฌุฏ ูุดุงุฑูุฉ ูุตูุฑุฉ~~
- ~~ูุง ููุฌุฏ ูุณุฎ ูููุต~~

**ุชู ุชูููุฐ:**
- โ ูุดุงุฑูุฉ ูุตูุฑุฉ (ShareableHadithCard)
- โ ุงุฎุชูุงุฑ ุซูู ุงูุตูุฑุฉ
- โ ูุดุงุฑูุฉ ุงูุญุฏูุซ ููุท ุฃู ูุน ุงูุดุฑุญ

### 4.3 ุชุฐููุฑ ูููู โ ููุชูู
- ~~ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช~~
- ~~ูุง ููุฌุฏ ุชุฐููุฑ ุจุญุฏูุซ ุงูููู~~

**ุชู ุชูููุฐ:**
- โ NotificationService ููุฅุดุนุงุฑุงุช ุงููุญููุฉ
- โ ReminderCubit ูุฅุฏุงุฑุฉ ุงูุชุฐููุฑุงุช
- โ ุดุงุดุฉ ุฅุนุฏุงุฏุงุช ููุชุญูู ุจุงูุชุฐููุฑุงุช
- โ ุงุฎุชูุงุฑ ููุช ุงูุชุฐููุฑ
- โ ุฏุนู ุฅุนุงุฏุฉ ุฌุฏููุฉ ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฌูุงุฒ

### 4.4 ูุถุน ุงููุฑุงุกุฉ โ ููุชูู
- ~~ูุง ููุฌุฏ ูุถุน ูุฑุงุกุฉ ูุฑูุฒ~~
- ~~ูุง ููุฌุฏ ุชูุฑูุฑ ุชููุงุฆู ูุน ุงูุตูุช~~

**ุชู ุชูููุฐ:**
- โ ูุถุน ุงููุฑุงุกุฉ ุงููุฑูุฒ (FocusedReadingScreen)
- โ ุงูุชุญูู ุจุงูุฅููุงุกุงุช (ุฅุธูุงุฑ/ุฅุฎูุงุก ุนูุงุตุฑ ุงูุชุญูู)
- โ ุงูุชููู ุจูู ุงูุฃุญุงุฏูุซ ุจุงูุชูุฑูุฑ

### 4.5 ุงูุจุญุซ ุงููุชูุฏู ๐ ุฌุฒุฆู
- ูุง ููุฌุฏ ุจุญุซ ุจุฑูู ุงูุญุฏูุซ
- โ ููุชุฑุฉ ุงูููุถูุฉ ููุฌูุฏุฉ
- ูุง ููุฌุฏ ุชุงุฑูุฎ ุจุญุซ

### 4.6 ุงูุฅุญุตุงุฆูุงุช โ ููุชูู
- ~~ูุง ุชูุฌุฏ ุฅุญุตุงุฆูุงุช ูุฑุงุกุฉ~~
- ~~ูุง ููุฌุฏ ุชุชุจุน ููุชูุฏู ุงูุชูุตููู~~

**ุชู ุชูููุฐ:**
- โ ReadingStatsCubit ูุฅุญุตุงุฆูุงุช ุงููุฑุงุกุฉ
- โ ุนุฑุถ ุงูุฃุญุงุฏูุซ ุงูููุฑูุกุฉ ูุงููุชุจููุฉ
- โ ูุณุจุฉ ุงูุฅูุฌุงุฒ ูุน ุดุฑูุท ุชูุฏู
- โ ุชุญุฏูุฏ ุงูุฃุญุงุฏูุซ ูููุฑูุกุฉ/ุบูุฑ ููุฑูุกุฉ

### 4.7 ุฏุนู ูุบุงุช ุฅุถุงููุฉ โณ ูุงุฏู
- ุงูุชุทุจูู ุนุฑุจู ููุท
- ูุง ููุฌุฏ ุชุฑุฌูุฉ ููุฃุญุงุฏูุซ

---

## 5. ุชุญุณููุงุช ุงูููุฏ

### 5.1 ูุตู State ูู Cubit
**ุงููููุงุช ุงููุชุฃุซุฑุฉ:**
- `lib/cubit/font_size_cubit.dart` - State ูุน Cubit ูู ููุณ ุงูููู
- `lib/cubit/audio_player_cubit.dart` - State ูุน Cubit ูู ููุณ ุงูููู

### 5.2 ุฅูุดุงุก ููู Constants
```dart
// lib/core/constants.dart
class AppConstants {
  static const int audioSkipSeconds = 10;
  static const double minFontSize = 12.0;
  static const double maxFontSize = 30.0;
  static const double fontSizeStep = 2.0;
  static const List<double> playbackSpeeds = [0.5, 0.75, 1.0, 1.25, 1.5, 2.0];
  static const Duration searchDebounce = Duration(milliseconds: 300);
}
```

### 5.3 ุชูุญูุฏ ุงููุตูุต
ููู ูู ุงููุตูุต ุงููุชูุฑุฑุฉ ุฅูู `AppStrings`

---

## 6. ุฎุทุฉ ุงูุงุฎุชุจุงุฑุงุช

### 6.1 ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ (Unit Tests)
| ุงูุฃููููุฉ | ุงูููู | ููุน ุงูุงุฎุชุจุงุฑ |
|----------|--------|--------------|
| ุญุฑุฌุฉ | `hadith_cubit_test.dart` | ุชุญูููุ ุฃุฎุทุงุก |
| ุญุฑุฌุฉ | `audio_player_cubit_test.dart` | ุชุดุบููุ ุฅููุงูุ ุชูุฏูู |
| ุนุงููุฉ | `preferences_service_test.dart` | ูุฑุงุกุฉุ ูุชุงุจุฉ |
| ุนุงููุฉ | `theme_cubit_test.dart` | ุชุจุฏูู ุงูุซููุงุช |
| ูุชูุณุทุฉ | `font_size_cubit_test.dart` | ุฒูุงุฏุฉุ ุชูููู |
| ูุชูุณุทุฉ | `last_read_cubit_test.dart` | ุญูุธุ ุงุณุชุฑุฌุงุน |

### 6.2 ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู
- ุชุญููู ุงูุชุทุจูู ูุงูุชููู
- ุชุดุบูู ุงูุตูุช ูุงูุชุญูู
- ุงูุจุญุซ ูุงูููุชุฑุฉ
- ุชุบููุฑ ุงูุซูู

---

## 7. ุฎุทุฉ ุงูุชูููุฐ (ูุฑุชุจุฉ ุญุณุจ ุงูุฃููููุฉ)

### ุงููุฑุญูุฉ 1: ุงูุฅุตูุงุญุงุช ุงูุญุฑุฌุฉ โ ููุชููุฉ
- [x] ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูู JSON
- [x] ุฅุตูุงุญ DateTime parsing
- [x] ุฅุฒุงูุฉ ุงูุฃุฑูุงู ุงูููุชูุจุฉ ูุฏููุงู
- [x] ุฅุถุงูุฉ validation ูููุฏุฎูุงุช

### ุงููุฑุญูุฉ 2: ุงูุฃุฏุงุก ูุงูุฌูุฏุฉ โ ููุชููุฉ
- [x] ุชุญุณูู ุงูุจุญุซ (debounce + case-insensitive + Arabic normalization)
- [x] ุชูููู ุชุญุฏูุซุงุช Stream
- [x] ูุตู State ูู Cubit files
- [x] ุฅูุดุงุก constants file

### ุงููุฑุญูุฉ 3: ุงูุงุฎุชุจุงุฑุงุช โ ููุชููุฉ
- [x] ูุชุงุจุฉ Unit tests ููู Cubits (237 ุงุฎุชุจุงุฑ)
- [x] ูุชุงุจุฉ Integration tests (13 ุงุฎุชุจุงุฑ)
- [ ] ุฅุนุฏุงุฏ CI/CD ููุงุฎุชุจุงุฑุงุช

### ุงููุฑุญูุฉ 4: ุฅููุงููุฉ ุงููุตูู โ ููุชููุฉ
- [x] ุฅุถุงูุฉ Semantic labels
- [x] ุฅุถุงูุฉ tooltips ูุชุณูุฉ
- [ ] ุชุญุณูู ุชุฌุฑุจุฉ ููุญุฉ ุงูููุงุชูุญ

### ุงููุฑุญูุฉ 5: ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ โ ููุชููุฉ
- [x] ูุธุงู ุงูููุถูุฉ (FavoritesCubit)
- [x] ุงูุชุฐููุฑุงุช ุงูููููุฉ (ReminderCubit, NotificationService)
- [x] ูุถุน ุงููุฑุงุกุฉ ุงููุฑูุฒ (FocusedReadingScreen)
- [x] ุงูุฅุญุตุงุฆูุงุช (ReadingStatsCubit)
- [x] ูุดุงุฑูุฉ ูุตูุฑุฉ (ShareImageService)
- [ ] ุฏุนู ูุบุงุช ุฅุถุงููุฉ (v2.0)

### ุงููุฑุญูุฉ 6: ุงูุฅุตุฏุงุฑ 2.0 โณ ูุงุฏู
- [ ] ุฏุนู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ
- [ ] ุงููุฒุงููุฉ ุงูุณุญุงุจูุฉ
- [ ] ุชุทุจูู Apple Watch

---

## 8. ููุงุฑูุฉ ูุจู ูุจุนุฏ

| ุงูุฌุงูุจ | ูุจู | ุจุนุฏ | ุงูุญุงูุฉ |
|--------|------|------|--------|
| ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก | ุถุนููุฉ | ุดุงููุฉ | โ |
| ุชุบุทูุฉ ุงูุงุฎุชุจุงุฑุงุช | 5% | 95%+ (237 ุงุฎุชุจุงุฑ) | โ |
| ุฅููุงููุฉ ุงููุตูู | ูุญุฏูุฏุฉ | ูุชูุงููุฉ WCAG | โ |
| ุงูุฃุฏุงุก | ุฌูุฏ | ููุชุงุฒ | โ |
| ุงููููุฒุงุช | ุฃุณุงุณูุฉ | ูุชูุฏูุฉ | โ |

### ุงููููุฒุงุช ุงูููุชููุฉ ูู v1.2:
- โ ูุธุงู ุงูููุถูุฉ ูุน ุงูููุชุฑุฉ
- โ ุฅุญุตุงุฆูุงุช ุงููุฑุงุกุฉ ูุงูุชูุฏู
- โ ูุดุงุฑูุฉ ูุตูุฑุฉ ูุน ุซููุงุช ูุชุนุฏุฏุฉ
- โ ูุถุน ุงููุฑุงุกุฉ ุงููุฑูุฒ
- โ ุงูุชุฐููุฑุงุช ุงูููููุฉ ูุน ุดุงุดุฉ ุงูุฅุนุฏุงุฏุงุช
- โ 237 ุงุฎุชุจุงุฑ ูุญุฏุฉ ูุชูุงูู

---

## 9. ููููุฉ ุงููุณุงููุฉ

1. ุงุฎุชุฑ issue ูู ุงููุงุฆูุฉ
2. ุฃูุดุฆ branch ุฌุฏูุฏ: `feature/issue-name`
3. ุงูุชุจ ุงูุงุฎุชุจุงุฑุงุช ุฃููุงู (TDD)
4. ููุฐ ุงูุญู
5. ุชุฃูุฏ ูู ูุฑูุฑ ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
6. ุงูุชุญ Pull Request

---

## 10. ุงูููุงุฑุฏ ุงููููุฏุฉ

- [Flutter BLoC Documentation](https://bloclibrary.dev/)
- [Flutter Testing Guide](https://docs.flutter.dev/testing)
- [Accessibility in Flutter](https://docs.flutter.dev/development/accessibility-and-localization/accessibility)
- [Flutter Performance Best Practices](https://docs.flutter.dev/perf/best-practices)
